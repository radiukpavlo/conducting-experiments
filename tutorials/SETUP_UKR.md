# Налаштування середовища для написання коду з PyTorch

Налаштування власного середовища для кодування глибокого навчання може бути досить складним завданням.

Від апаратного забезпечення до програмного, щоб ваш код працював на іншому комп'ютері так само, як він працює на вашій.

На цьому курсі ми виконуватимемо обрахунки простіше.

Розглянемо два варіанти налаштування середовища:

1. Google Colab (простіший).
2. Налаштування середовища на власному локальному/віддаленому комп’ютері (на кілька кроків більше, але за такого підходу ви матимете трохи більше гнучкості).

Перший простіший за другий, але другий пропонує більше можливостей у довгостроковій перспективі.

**Примітка** Жоден із вище вказаних підходів не є заміною для [офіційної документації налаштування PyTorch](https://pytorch.org/get-started/locally/). Якщо ви хочете почати кодувати PyTorch на довгострокову перспективу, вам слід познайомитися з цим туторіалом.

## 1. Налаштування середовища із Google Colab (простіший)

Google Colab — це безоплатний онлайн-інструмент інтерактивних обчислень (на основі Jupyter Notebooks, що є стандартом в data science).

Переваги Google Colab:
* Майже нульове налаштування (Google Colab подається користувачам з уже встановленими PyTorch і багатьма іншими пакетами обробки даних, як-от Pandas, NumPy, Matplotlib тощо).
* Є можливість поділитися своїм кодом за посиланням.
* Безоплатний доступ до графічних процесорів GPU (графічні процесори роблять ваш код глибокого навчання швидшим), з платною опцією доступу до *більшої* потужності графічного процесора.

Мінуси Google Colab:
* Тайм-аути (більшість блокнотів Colab зберігають стан максимум протягом 2-3 годин, хоча це може збільшитися з платною опцією).
* Немає доступу до локального сховища (хоча це можна обійти з допомогою Google Drive).
* Погане налаштування сценаріїв коду (групування коду в модулі).

### Використовуйте Google Colab для написання коду, щоб перевіряти гіпотези, а далі збільшуйте масштаб за потреби.

Для перших блокнотів курсу (00-04) ми будемо використовувати виключно Google Colab, тому що це більш ефективно.

Велику кількість початкової та експериментальної роботи можна виконувати в Google Colab.

А далі реалізовані ідеї можна перетворити на більший проект або попрацювати над чимось іншим у локальному або хмарному середовищі.

### Початок роботи з Google Colab

Із Google Colab можна познайомитися чероез [Вступ до блокнота Google Colab](https://colab.research.google.com/notebooks/basic_features_overview.ipynb) (тут можна ознайомитися з усіма дзвіночками та кнопками).

### Відкриття блокнота курсу в одне натискання

Ознайомившись з інтерфейсом Google Colab, ви можете запустити перший блокнот курсу безпосередньо в Google Colab, натиснувши кнопку «Відкрити в Colab» у верхній частині блокнота.

![відкрийте блокнот курсу в Google Colab за допомогою кнопки «Відкрити в Colab».](https://raw.githubusercontent.com/mrdbourke/pytorch-deep-learning/main/images/setup-open-in-colab-cropped.gif)

Якщо ви хочете зробити копію блокнота та зберегти її на своєму Google Диску, ви можете натиснути кнопку «Копіювати на Диск».

### Відкриття блокнота в Google Colab за посиланням

Ви також можете ввести будь-яке посилання на блокнот із репозитарію GitHub безпосередньо в Google Colab і отримати той самий результат.

![відкрийте блокнот курсу в Google Colab за посиланням GitHub](https://raw.githubusercontent.com/mrdbourke/pytorch-deep-learning/main/images/setup-open-notebook-in-colab-via-link. png)

Виконавши таку операцію, ви отримаєте робочий блокнот прямо в Google Colab.

Зауважу, що наполегливо рекомендую вам **написати код самостійно**, а не запускати наявний код із комірок.

### Отримання доступу до GPU в Google Colab

Щоб отримати доступ до графічного процесора NVIDIA з підтримкою CUDA (CUDA — це інтерфейс програмування, який прискорює обчислення коду глибокого навчання завдяки графічним процесорам) у Google Colab, ви можете перейти до `Runtime -> Change runtime type -> Hardware Accelerator -> GPU` (примітка: цей варіант потребуватиме перезапуску середовища виконання).

![Отримання доступу до GPU в Google Colab](https://raw.githubusercontent.com/mrdbourke/pytorch-deep-learning/main/images/setup-get-gpu-colab-cropped.gif)

Щоб перевірити, чи є у вас активний графічний процесор у Google Colab, виконайте:

```
!nvidia-smi
```

Якщо у вас є доступ до GPU, команда вище продемонструє, до якого типу GPU у вас є доступ.

А щоб перевірити, чи має PyTorch доступ до GPU, ви можете виконати:

```python
import torch # Google Colab поставляється з уже встановленим torch
print(torch.cuda.is_available()) # поверне True, якщо PyTorch може використовувати GPU
```

Якщо PyTorch має доступ до графічного процесора у Google Colab, вище буде виведення `True`.

## 2. Налаштування середовища на власному локальному/віддаленому комп’ютері

> **Примітка.** Нагадування, що це не заміна [офіційній документації PyTorch для локального налаштування](https://pytorch.org/get-started/locally/). Це лише один спосіб налаштування (їх багато), розроблений спеціально для цього курсу.

Це **налаштування опирається на операційну систему Windows**. Якщо ви використовуєте macOS або Linux, вам варто звернутися до документації PyTorch.

Це налаштування також **очікує, що ви матимете доступ до графічного процесора NVIDIA**.

### Етапи локального налаштування для системи Windows із графічним процесором

1. [Інсталювання Anaconda](https://www.anaconda.com/products/distribution).
Головне тут - це отримати доступ до віртуального середовища `conda` в командному рядку.

2. Створіть теку для матеріалів курсу; ви можете назвати його як завгодно. Наприклад,
```
mkdir amp-course
cd amp-course
```
3. Створіть віртуальне середовище `conda` у щойно створеному каталозі. Наступна команда створить середовище `conda`, яке знаходиться в теці під назвою `env`, яка знаходиться в теці, яку ви щойно створили (наприклад, `amp-course/env`). Натисніть `y`, коли команда нижче запитає `y/n?`.
```
conda create --prefix ./env python=3.8
```
4. Активуйте щойно створене середовище.
```
conda activate ./env
```
5. Інсталюйте сюди необхідні залежні бібліотеки, які вам знадобляться для курсу, наприклад PyTorch і CUDA Toolkit для запуску PyTorch на вашому GPU. Ви можете запустити все це одночасно:
```
conda install -c pytorch pytorch=1.10.0 torchvision cudatoolkit=11.3 -y
conda install -c conda-forge jupyterlab torchinfo torchmetrics -y
conda install -c anaconda pip -y
conda install pandas matplotlib scikit-learn -y
```
>**Примітка.** За детялами звертайтесь до [документації з налаштування PyTorch](https://pytorch.org/get-started/locally/)).
6. Переконайтеся, що встановлення виконано правильно, запустивши сервер Jupyter Lab:

```bash
jupyter lab
```

7. Після запуску Jupyter Lab, запустіть Jupyter Launcher і виконайте наступний фрагмент коду в комірці.
```python
import pandas as pd
import numpy as np
import torch
import sklearn
import matplotlib
import torchinfo, torchmetrics

# Перевірте доступ до PyTorch (має вивести тензор)
print(torch.randn(3, 3))

# Перевірте GPU (має повернути True)
print(torch.cuda.is_available())
```

Якщо наведений вище код працює без помилок, ваше середовище повністю налаштоване та готове до роботи.

Якщо ви зіткнулися з помилкою, перейдіть на [сторінку документації з налаштування PyTorch](https://pytorch.org/get-started/locally/).